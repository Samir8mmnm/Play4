<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–∏—Ç–≤–∞ üéÆ</title>
    <link rel="stylesheet" href="style.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
    <div class="container">
        <h1>üéÆ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–∏—Ç–≤–∞</h1>

        <div id="connection-status" class="hidden"></div>

        <!-- –ù–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="start">
            <div class="card">
                <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫:</p>
                <input id="nick" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–π–¥–∞–Ω–∞" maxlength="15" value="–ò–≥—Ä–æ–∫">
                
                <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º:</p>
                <select id="mode">
                    <option value="single">üéØ –û–¥–∏–Ω–æ—á–Ω–∞—è –∏–≥—Ä–∞</option>
                    <option value="multi">üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä —Å –¥—Ä—É–∑—å—è–º–∏</option>
                </select>
                
                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–¥–∏–Ω–æ—á–Ω–æ–π –∏–≥—Ä—ã -->
                <div id="single-settings">
                    <p>–°–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤? (1-50)</p>
                    <input id="auto-count" type="number" min="1" max="50" value="10">
                    <button onclick="startSingleGame()" class="success">üéÆ –ù–∞—á–∞—Ç—å –æ–¥–∏–Ω–æ—á–Ω—É—é –∏–≥—Ä—É</button>
                </div>
                
                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–∞ -->
                <div id="multi-settings" class="hidden">
                    <button onclick="createRoom()" class="success">üé™ –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                    <div style="text-align:center; margin:15px 0;">‚Äî –ò–õ–ò ‚Äî</div>
                    <p>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ:</p>
                    <div style="display:flex; gap:10px;">
                        <input id="room-code" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥" style="flex:1;" maxlength="4" pattern="[A-Z0-9]{4}">
                        <button onclick="joinRoom()" class="secondary">üîó –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
                    </div>
                    <div id="loader" class="loader hidden"></div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∏ –æ—Ç–ª–∞–¥–∫–∏ -->
                    <div style="margin-top: 20px; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                        <p style="font-size: 12px; color: #666; margin-bottom: 5px;">–û—Ç–ª–∞–¥–∫–∞:</p>
                        <button onclick="testFirebase()" style="font-size: 12px; padding: 5px 10px; background: #6c757d;">üîß –¢–µ—Å—Ç Firebase</button>
                        <button onclick="showDebugInfo()" style="font-size: 12px; padding: 5px 10px; background: #6c757d;">üêõ –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫–∏</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –õ–æ–±–±–∏ –¥–ª—è –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–∞ -->
        <div id="lobby" class="hidden">
            <div class="card">
                <div class="room-info">
                    <h2>üé™ –ö–æ–º–Ω–∞—Ç–∞: <span id="room-id-display">----</span></h2>
                    <p>–û—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –¥—Ä—É–∑—å—è–º:</p>
                    <div class="room-code" id="room-code-display">----</div>
                    <button onclick="copyRoomCode()" class="copy-btn">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
                    
                    <div style="margin-top: 15px; padding: 10px; background: #e9ecef; border-radius: 5px;">
                        <p style="margin: 0; font-size: 14px; color: #495057;">
                            üì± <strong>–°—Å—ã–ª–∫–∞ –¥–ª—è –¥—Ä—É–∑–µ–π:</strong><br>
                            <span id="share-link" style="font-size: 12px; color: #007bff;"></span>
                        </p>
                    </div>
                </div>
                
                <div id="countdown" class="countdown hidden">3</div>
                
                <h3>üë• –ò–≥—Ä–æ–∫–∏ (<span id="players-count">0</span>/8):</h3>
                <div class="player-list" id="players-list"></div>
                
                <div id="lobby-controls">
                    <button onclick="leaveRoom()" class="danger">üö™ –ü–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                    <button onclick="toggleReady()" id="ready-btn" class="secondary">‚úÖ –Ø –≥–æ—Ç–æ–≤</button>
                    <button onclick="startRoomGame()" id="start-btn" class="success hidden">‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                    <button onclick="forceStartGame()" id="force-start-btn" class="danger hidden" style="margin-top:10px;">
                        üöÄ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—á–∞—Ç—å
                    </button>
                </div>
                
                <div class="control-buttons">
                    <button onclick="location.reload()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ -->
        <div id="test" class="hidden">
            <div class="timer" id="timer">–í—Ä–µ–º—è: 0 —Å–µ–∫</div>
            <div class="progress-container">
                <div class="progress-bar" id="prog"></div>
            </div>
            <div class="card">
                <h2 id="q"></h2>
                <div id="options"></div>
            </div>
            
            <div class="live-results" id="live-results">
                <h4>üèÜ –¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h4>
                <div id="live-results-content"></div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <div id="end" class="hidden">
            <h2 id="res"></h2>
            <div id="winner" class="winner hidden">üéâ –ü–æ–±–µ–¥–∏—Ç–µ–ª—å! üéâ</div>
            
            <div class="card">
                <h3>üèÜ –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h3>
                <table>
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–ë–∞–ª–ª—ã</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–¢–æ—á–Ω–æ—Å—Ç—å</th>
                        </tr>
                    </thead>
                    <tbody id="final-results"></tbody>
                </table>
            </div>
            
            <!-- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
            <div class="card detailed-results hidden" id="detailed-results">
                <h3>üìä –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h3>
                <div id="answers-list"></div>
            </div>
            
            <div class="control-buttons">
                <button onclick="showDetailedResults()" class="secondary" id="details-btn">üìä –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                <button onclick="location.reload()" class="success">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <button onclick="returnToLobby()" class="secondary hidden" id="return-btn">üè† –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ª–æ–±–±–∏</button>
            </div>
        </div>
    </div>

    <!-- –°–µ–∫—Ä–µ—Ç–Ω–æ–µ –∫–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã -->
    <div id="wheel-container" class="wheel-container hidden">
        <div class="wheel-title">üé° –°–ï–ö–†–ï–¢–ù–û–ï –ö–û–õ–ï–°–û –§–û–†–¢–£–ù–´! üé°</div>
        <div class="wheel" id="wheel">
            <div class="wheel-pointer"></div>
        </div>
        <button class="spin-btn" id="spin-btn" onclick="spinWheel()">üéØ –ö–†–£–¢–ò–¢–¨ –ö–û–õ–ï–°–û!</button>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º -->
    <div id="result-modal" class="result-modal hidden">
        <div class="result-icon" id="result-icon">üéÅ</div>
        <div class="result-text" id="result-text">–ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!</div>
        <div class="result-description" id="result-description">–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ –ø—Ä–∏–∑!</div>
        <button class="close-btn" onclick="closeResult()">üéÆ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É</button>
    </div>

    <!-- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
    <div id="debug-panel" class="debug-panel hidden">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
            <h4 style="margin:0;">üêõ –û—Ç–ª–∞–¥–∫–∞</h4>
            <button onclick="document.getElementById('debug-panel').classList.add('hidden')" style="background:none; border:none; color:white; font-size:20px; cursor:pointer;">√ó</button>
        </div>
        <div id="debug-content" style="font-family:monospace; font-size:12px; line-height:1.4; max-height:300px; overflow-y:auto;"></div>
        <div style="margin-top:10px;">
            <button onclick="clearDebug()" style="padding:5px 10px; font-size:12px; background:#6c757d;">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
            <button onclick="testFirebase()" style="padding:5px 10px; font-size:12px; background:#17a2b8;">üîß –¢–µ—Å—Ç Firebase</button>
        </div>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ª–∞–¥–∫–∏ -->
    <button id="debug-btn" onclick="toggleDebug()" style="position:fixed; bottom:20px; right:20px; width:50px; height:50px; border-radius:50%; background:#dc3545; color:white; border:none; font-size:24px; z-index:9998; cursor:pointer; box-shadow:0 2px 10px rgba(0,0,0,0.3);">üêõ</button>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º JavaScript -->
    <script src="script.js"></script>
</body>
</html>
